(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))o(e);new MutationObserver(e=>{for(const r of e)if(r.type==="childList")for(const i of r.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&o(i)}).observe(document,{childList:!0,subtree:!0});function a(e){const r={};return e.integrity&&(r.integrity=e.integrity),e.referrerPolicy&&(r.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?r.credentials="include":e.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function o(e){if(e.ep)return;e.ep=!0;const r=a(e);fetch(e.href,r)}})();const m="2f8a639f-e16c-42b6-9657-d79de7f86aef",f="https://v2.api.noroff.dev/auth/register",g="https://v2.api.noroff.dev/auth/login";function c(){const n={"Content-Type":"application/json","X-Noroff-API-Key":m},t=localStorage.getItem("my_token");return t&&(n.Authorization=`Bearer ${t}`),n}async function y(n,t,a){const o={name:n,email:t,password:a};try{const e=await fetch(f,{method:"POST",headers:c(),body:JSON.stringify(o)}),r=await e.json();e.ok?(alert("Registration successful!"),window.location.href="/auth/login/index.html"):alert(`Error: ${r.message}`)}catch(e){console.error("Registration failed:",e),alert("An error occurred. Please try again.")}}document.addEventListener("DOMContentLoaded",function(){document.querySelector('form[name="register"]').addEventListener("submit",async function(n){n.preventDefault(),document.getElementById("name-error").textContent="",document.getElementById("email-error").textContent="",document.getElementById("password-error").textContent="";const t=document.getElementById("name").value,a=document.getElementById("email").value,o=document.getElementById("password").value;let e=!0;/^[\w]+$/.test(t)||(document.getElementById("name-error").textContent="Name must only contain letters, numbers, or underscores.",e=!1),/^[\w\-.]+@(stud\.)?noroff\.no$/.test(a)||(document.getElementById("email-error").textContent="Please enter a valid stud.noroff.no email address.",e=!1),o.length<8&&(document.getElementById("password-error").textContent="Password must be at least 8 characters long.",e=!1),e&&await y(t,a,o)})});async function h(n,t){const a={email:n,password:t};try{const o=await fetch(g,{method:"POST",headers:c(),body:JSON.stringify(a)}),e=await o.json();if(o.ok)localStorage.setItem("my_token",e.data.accessToken),window.location.href="/index.html";else throw new Error("Incorrect credentials. Please check your email and password.")}catch{throw new Error("An error occurred while logging in. Please try again.")}}localStorage.removeItem("token");localStorage.removeItem("username");document.addEventListener("DOMContentLoaded",function(){document.querySelector('form[name="login"]').addEventListener("submit",async function(n){n.preventDefault(),document.getElementById("email-error").textContent="",document.getElementById("password-error").textContent="",document.getElementById("login-error").textContent="";const t=document.getElementById("email").value,a=document.getElementById("password").value;let o=!0;if(/^[\w\-.]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(t)||(document.getElementById("email-error").textContent="Please enter a valid email address.",o=!1),o)try{await h(t,a)}catch{document.getElementById("login-error").textContent="Login failed. Please check your credentials and try again."}})});function l(){confirm("Are you sure you want to log out?")&&(localStorage.removeItem("my_token"),alert("You have been logged out successfully."),window.location.href="/auth/login/index.html")}let d;function u(){d=setTimeout(()=>{alert("You have been logged out due to inactivity."),l()},3e5)}function s(){clearTimeout(d),u()}function w(){window.addEventListener("mousemove",s),window.addEventListener("keydown",s),window.addEventListener("click",s),u()}function p(){const n=document.createElement("header"),t=document.createElement("button");t.textContent="Home",t.onclick=()=>window.location.href="/index.html";const a=document.createElement("button");a.textContent="Profile",a.onclick=()=>window.location.href="/profile";const o=document.createElement("button");o.textContent="Logout",o.onclick=l;const e=document.createElement("button");e.textContent="Login",e.onclick=()=>window.location.href="auth/login/index.html";const r=localStorage.getItem("my_token");n.append(t),r?n.append(a,o):n.append(e),document.body.prepend(n)}window.onload=()=>{p(),w()};
